<!doctype html><html lang=en dir=auto><head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=443&amp;path=blog/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Requim of TornadoCash | jchauhn's writeups</title>
<meta name=keywords content="cash,tornado,cryptocurrency,mixer,solidity,web3,blockchain"><meta name=description content="PoC implmentation of Tornado Cash on the Ethereum blockchain"><meta name=author content="Me"><link rel=canonical href=https://jchauhn.github.io:443/blog/posts/tornadocash/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://jchauhn.github.io:443/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://jchauhn.github.io:443/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://jchauhn.github.io:443/blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://jchauhn.github.io:443/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://jchauhn.github.io:443/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://jchauhn.github.io:443/blog/posts/tornadocash/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://jchauhn.github.io:443/blog/posts/tornadocash/"><meta property="og:site_name" content="jchauhn's writeups"><meta property="og:title" content="Requim of TornadoCash"><meta property="og:description" content="PoC implmentation of Tornado Cash on the Ethereum blockchain"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-09T11:30:03+00:00"><meta property="article:modified_time" content="2025-06-09T11:30:03+00:00"><meta property="article:tag" content="Cash"><meta property="article:tag" content="Tornado"><meta property="article:tag" content="Cryptocurrency"><meta property="article:tag" content="Mixer"><meta property="article:tag" content="Solidity"><meta property="article:tag" content="Web3"><meta property="og:image" content="https://jchauhn.github.io:443/blog/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jchauhn.github.io:443/blog/%3Cimage%20path/url%3E"><meta name=twitter:title content="Requim of TornadoCash"><meta name=twitter:description content="PoC implmentation of Tornado Cash on the Ethereum blockchain"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jchauhn.github.io:443/blog/posts/"},{"@type":"ListItem","position":2,"name":"Requim of TornadoCash","item":"https://jchauhn.github.io:443/blog/posts/tornadocash/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Requim of TornadoCash","name":"Requim of TornadoCash","description":"PoC implmentation of Tornado Cash on the Ethereum blockchain","keywords":["cash","tornado","cryptocurrency","mixer","solidity","web3","blockchain"],"articleBody":"TLDR This is Proof-of-Concept which mimics the core functionality of Torando Cash. This project walks you though creating a a smart contract using Solidity and Circom to create a Zero-Knowledge (ZK) Proof based deposit and withdrawal system. This provides complete anonymity for both the reciver and deposit (given that no browser fingerprinting is taking place).\nNo one not even the writer of the msart contract nor the EVM can match a given withdrawal to its deposit. Obviously, lack of transparency in cryptocurrecy transfers can cause significant headaches for power to be (banks, exchnages, US Gov) so back in 2022, The US government sactioned Tornado Cash and the Dutch police arrested its creator (who is still jailed on money laundering charges)\nHowever, this year (Jan 2025), the US courts dismissed the sanctions against Tornado Cash stating that this is no longer a forbidden dark sorcery.\nNow you can make you own haven for DPRK hackers. here is how\nDISCLAIMER The entirety of this project is shown here for solely educational purposes. The author of this project takes no responsiblity for the end-use cases of this technology by anyone who reads it. Please deploy and interact at your own risk. Also note that this technology might not be legal in your jurisdiction. Please engage in due diligence before deploying your own instance.\nIntroduction Tornado Cash was back the news recently due to lifting of US sanctions. The website was under sanctions due to (alleged) money laundering charges. The US government argued that the website facilitated money laundering by hacking outfits such as Lazarus and processed amounts exceeding ~$1billion USD. However, this year, the courts ruled that the fundamental technology behind Torando Cash, the EVM Smart Contracts which contain the ZK based logic do not constitute property and thus its creators can be held liable for the its misuse (Ask your friendly US lawyer for details)\nThis blog will explain how the ZK based logic works.\nIndex What is a Smart Contract What are ZK Proofs Solidity and Circom Tornado Cash Design What is a Smart Contract A Smart contract is bytecode on a blockchain which executed under certain conditions. It can recieve inputs; it can produce output; it can preserve state and interact with other contracts in the blockchain.\nA smart contract exists at a fixed address on the blockchain. Not all blockchains support smart contracts; Ethereum does while Bitcoin doesn‚Äôt. On Ethereum blockchain, a smart contract is also called a EVM or Etherum Virtual Machine. These terms can abd will be used interchangebly in the blogpost.\nTo interact with a EVM, you send a transaction to it‚Äôs address on the blockchain. The trasanction can contain inputs on which the EVM will act on and it can also signal output for the user who sent that transaction. The format of the transaction can vary and is dependent on the EVM.\nA smart contract/EVM basically functions as virtual computer; it has compute and it can have storage. The compute and the storage are not predefined. Instead, a user for a smart contract pays for both compute and storage when sending a transaction using gas fees (basically transaction fees paid in Eth) Each user pays for the marginal change in the storage (read/write costs) as well as the compute cost required by the EVM to process just that specific transaction. These costs can vary between transactions and are dependent on the design on the smart contract. More compute and more storage require more gas fees. Ideally, the smart contract designer will have designed the contarct to use the minimum possible amount of gas possible. Note: this implmentation is not optimized so deploying this will result in higher gas fees than tornado cash\nWhat are ZK proof? This chatgpt‚Äôs summary:\n** Zero-Knowledge Proofs (ZK Proofs) are cryptographic techniques that allow one party (called the prover) to prove to another party (called the verifier) that a statement is true without revealing any information beyond the truth of the statement itself.\nüîç Simple Analogy Imagine you want to prove you know the password to a door, but you don‚Äôt want to reveal the actual password. A ZK proof is like being able to demonstrate that you can open the door (showing you know the password), without ever telling the verifier what the password is. **\nTornado Cash uses ZK proof to allow a withdrawer to prove that they hold a receipt for an existing deposit without disclosing which deposit matches this withdrawal. When a deposit is made, the depositor recieves a secret note which is the sole item required for a successful withdrawal. The withdrawer must have the same secret to withdraw that deposit.\nNow, you may ask, how does Tornado cash know which deposit mathces that\n","wordCount":"790","inLanguage":"en","image":"https://jchauhn.github.io:443/blog/%3Cimage%20path/url%3E","datePublished":"2025-06-09T11:30:03Z","dateModified":"2025-06-09T11:30:03Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jchauhn.github.io:443/blog/posts/tornadocash/"},"publisher":{"@type":"Organization","name":"jchauhn's writeups","logo":{"@type":"ImageObject","url":"https://jchauhn.github.io:443/blog/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jchauhn.github.io:443/blog/ accesskey=h title="Home (Alt + H)"><img src=https://jchauhn.github.io:443/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jchauhn.github.io:443/blog/categories/ title=categories><span>categories</span></a></li><li><a href=https://jchauhn.github.io:443/blog/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jchauhn.github.io:443/blog/>Home</a>&nbsp;¬ª&nbsp;<a href=https://jchauhn.github.io:443/blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Requim of TornadoCash</h1><div class=post-description>PoC implmentation of Tornado Cash on the Ethereum blockchain</div><div class=post-meta><span title='2025-06-09 11:30:03 +0000 +0000'>June 9, 2025</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;790 words&nbsp;¬∑&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/tornadocash.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://jchauhn.github.io:443/blog/%3Cimage%20path/url%3E alt><p></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#disclaimer>DISCLAIMER</a></li><li><a href=#introduction>Introduction</a></li></ul><ul><li><a href=#what-is-a-smart-contract>What is a Smart Contract</a></li><li><a href=#what-are-zk-proof>What are ZK proof?</a></li></ul></nav></div></details></div><div class=post-content><h1 id=tldr>TLDR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h1><p>This is Proof-of-Concept which mimics the core functionality of Torando Cash. This project walks you though creating a
a smart contract using Solidity and Circom to create a Zero-Knowledge (ZK) Proof based deposit and withdrawal
system. This provides complete anonymity for both the reciver and deposit (given that no browser fingerprinting is taking place).</p><p>No one not even the writer of the msart contract nor the EVM can match a given withdrawal to its deposit.
Obviously, lack of transparency in cryptocurrecy transfers can cause significant headaches for power to be (banks, exchnages, US Gov) so back in 2022,
The US government sactioned Tornado Cash and the Dutch police arrested its creator (who is still jailed on money laundering charges)</p><p>However, this year (Jan 2025), the US courts dismissed the sanctions against Tornado Cash stating that this is no longer a forbidden dark sorcery.</p><p>Now you can make you own haven for DPRK hackers. here is how</p><h2 id=disclaimer>DISCLAIMER<a hidden class=anchor aria-hidden=true href=#disclaimer>#</a></h2><p>The entirety of this project is shown here for solely educational purposes. The author of this project takes no responsiblity for the end-use cases
of this technology by anyone who reads it. Please deploy and interact at your own risk.
Also note that this technology might not be legal in your jurisdiction. Please engage in due diligence before deploying your own instance.</p><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Tornado Cash was back the news recently due to lifting of US sanctions.
The website was under sanctions due to (alleged) money laundering charges. The US government argued that the website facilitated money laundering by hacking outfits
such as Lazarus and processed amounts exceeding ~$1billion USD. However, this year, the courts ruled that the fundamental technology behind Torando Cash, the
EVM Smart Contracts which contain the ZK based logic do not constitute property and thus its creators can be held liable for the its misuse (Ask your friendly US lawyer for details)</p><p>This blog will explain how the ZK based logic works.</p><h1 id=index>Index<a hidden class=anchor aria-hidden=true href=#index>#</a></h1><ul><li>What is a Smart Contract</li><li>What are ZK Proofs</li><li>Solidity and Circom</li><li>Tornado Cash Design</li></ul><h2 id=what-is-a-smart-contract>What is a Smart Contract<a hidden class=anchor aria-hidden=true href=#what-is-a-smart-contract>#</a></h2><p>A Smart contract is bytecode on a blockchain which executed under certain conditions. It can recieve inputs; it can produce output; it can preserve state and interact with other contracts in the blockchain.</p><p>A smart contract exists at a fixed address on the blockchain. Not all blockchains support smart contracts; Ethereum does while Bitcoin doesn&rsquo;t.
On Ethereum blockchain, a smart contract is also called a EVM or Etherum Virtual Machine. These terms can abd will be used interchangebly in the blogpost.</p><p>To interact with a EVM, you send a transaction to it&rsquo;s address on the blockchain. The trasanction can contain inputs on which the EVM will act on and it can also signal output for the user who sent that transaction.
The format of the transaction can vary and is dependent on the EVM.</p><p>A smart contract/EVM basically functions as virtual computer; it has compute and it can have storage. The compute and the storage are not predefined.
Instead, a user for a smart contract pays for both compute and storage when sending a transaction using gas fees (basically transaction fees paid in Eth)
Each user pays for the marginal change in the storage (read/write costs) as well as the compute cost required by the EVM to process just that specific transaction.
These costs can vary between transactions and are dependent on the design on the smart contract. More compute and more storage require more gas fees.
Ideally, the smart contract designer will have designed the
contarct to use the minimum possible amount of gas possible.
Note: this implmentation is not optimized so deploying this will result in higher gas fees than tornado cash</p><h2 id=what-are-zk-proof>What are ZK proof?<a hidden class=anchor aria-hidden=true href=#what-are-zk-proof>#</a></h2><p>This chatgpt&rsquo;s summary:</p><p>**
Zero-Knowledge Proofs (ZK Proofs) are cryptographic techniques that allow one party (called the prover) to prove to another party (called the verifier) that a statement is true without revealing any information beyond the truth of the statement itself.</p><p>üîç Simple Analogy
Imagine you want to prove you know the password to a door, but you don‚Äôt want to reveal the actual password. A ZK proof is like being able to demonstrate that you can open the door (showing you know the password), without ever telling the verifier what the password is.
**</p><p>Tornado Cash uses ZK proof to allow a withdrawer to prove that they hold a receipt for an existing deposit without disclosing which deposit matches this withdrawal.
When a deposit is made, the depositor recieves a secret note which is the sole item required for a successful withdrawal.
The withdrawer must have the same secret to withdraw that deposit.</p><p>Now, you may ask, how does Tornado cash know which deposit mathces that</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jchauhn.github.io:443/blog/tags/cash/>Cash</a></li><li><a href=https://jchauhn.github.io:443/blog/tags/tornado/>Tornado</a></li><li><a href=https://jchauhn.github.io:443/blog/tags/cryptocurrency/>Cryptocurrency</a></li><li><a href=https://jchauhn.github.io:443/blog/tags/mixer/>Mixer</a></li><li><a href=https://jchauhn.github.io:443/blog/tags/solidity/>Solidity</a></li><li><a href=https://jchauhn.github.io:443/blog/tags/web3/>Web3</a></li><li><a href=https://jchauhn.github.io:443/blog/tags/blockchain/>Blockchain</a></li></ul><nav class=paginav><a class=prev href=https://jchauhn.github.io:443/blog/posts/paper_backup/><span class=title>¬´ Prev</span><br><span>Paper USENIX</span>
</a><a class=next href=https://jchauhn.github.io:443/blog/posts/rpirouter/><span class=title>Next ¬ª</span><br><span>Setting up Raspberry Pi router</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://jchauhn.github.io:443/blog/>jchauhn's writeups</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>